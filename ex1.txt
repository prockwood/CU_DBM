-- UniversityDB table creation

CREATE TABLE Customer (
	 CustNo VARCHAR(8) CONSTRAINT CustNoNotNull NOT NULL,
	 CustName VARCHAR(30) CONSTRAINT CustNameNotNull NOT NULL,
	 Address VARCHAR(50) CONSTRAINT AdressNotNull NOT NULL,
	 Internal VARCHAR(1) CONSTRAINT InternalNotNull NOT NULL,
	 Contact VARCHAR(35) CONSTRAINT ContactNotNull NOT NULL,
	 Phone VARCHAR(11) CONSTRAINT PhoneNotNull NOT NULL,
	 City VARCHAR(30) CONSTRAINT CityNotNull NOT NULL,
	 State VARCHAR(2) CONSTRAINT StateNotNull NOT NULL,
	 Zip VARCHAR(10) CONSTRAINT ZipNotNull NOT NULL,
	 CONSTRAINT PK_CUSTOMER PRIMARY KEY (CustNo)
	 );


CREATE TABLE Facility (
	 FacNo VARCHAR(8) CONSTRAINT FacNoNotNull NOT NULL,
	 FacName VARCHAR(30) CONSTRAINT FacNameNotNull NOT NULL,
	 CONSTRAINT PK_FACILITY PRIMARY KEY (FacNo)
	 );


CREATE TABLE Location (
	 LocNo VARCHAR(8) CONSTRAINT LocNoNotNull NOT NULL,
	 FacNo VARCHAR(8) CONSTRAINT FacNoNotNull NOT NULL,
	 LocName VARCHAR(22) CONSTRAINT LocNoNotNull NOT NULL,
	 CONSTRAINT PK_LOCATION PRIMARY KEY (LocNo),
	 CONSTRAINT FK_LOCATION FOREIGN KEY (FacNo) REFERENCES FACILITY (FacNo),
	 CONSTRAINT Unique_FacName UNIQUE(FacName)
	);


CREATE TABLE Employee (
	 EmpNo VARCHAR(8) CONSTRAINT LocNoNotNull NOT NULL,
	 EmpName VARCHAR(40) CONSTRAINT FacNoNotNull NOT NULL,
	 Department VARCHAR(30) CONSTRAINT LocNoNotNull NOT NULL,
	 Email VARCHAR(50),
	 Phone VARCHAR(15),
	 CONSTRAINT PK_EMPLOYEE PRIMARY KEY (EmpNo)
	 );


CREATE TABLE ResourceTbl (
	 ResNo VARCHAR(8) CONSTRAINT ResNoNotNull NOT NULL,
	 ResName VARCHAR(40) CONSTRAINT ResNameNotNull NOT NULL,
	 Rate NUMERIC CONSTRAINT RateNotNull NOT NULL,
	 CONSTRAINT PK_ResourceTbl PRIMARY KEY (ResNo),
	 CONSTRAINT Res_Rate_Check CHECK(Rate > 0.0)
	 );


CREATE TABLE EventRequest (
	 EventNo VARCHAR(8) CONSTRAINT EventNoNotNull NOT NULL,
	 DateHeld DATE,
	 DateReq DATE,
	 FacNo VARCHAR(8) CONSTRAINT FacNoNotNull NOT NULL,
	 CustNo VARCHAR(8) CONSTRAINT CustNoNotNull NOT NULL,
	 DateAuth DATE,
	 Status VARCHAR(20) CONSTRAINT StatusNotNull NOT NULL,
	 EstCost NUMERIC(100,2) CONSTRAINT EstCostNotNUll NOT NULL,
	 EstAudience NUMERIC CONSTRAINT EstAudienceNotNull NOT NULL,
	 BudNo VARCHAR(10),
	 CONSTRAINT PK_EventRequest PRIMARY KEY (EventNo),
	 CONSTRAINT FK_EventRequest_CustNo FOREIGN KEY (CustNo) REFERENCES CUSTOMER (CustNo),
	 CONSTRAINT FK_EventRequest_FacNo FOREIGN KEY (FacNo) REFERENCES FACILITY (FacNo),
	 CONSTRAINT EventRequest_Status_Cats CHECK (Status IN ('Approved', 'Pending', 'Denied')) 
	 );


CREATE TABLE EventPlan (
	PlanNo VARCHAR(8) CONSTRAINT PlanNoNotNull NOT NULL,
	EventNo VARCHAR(8) CONSTRAINT EventNoNotNull NOT NULL,
	WorkDate DATE CONSTRAINT WorkDateNotNull NOT NULL,
	Notes VARCHAR(240),
	CustNo VARCHAR(8) CONSTRAINT CustNoNotNull NOT NULL,
	Activity VARCHAR(10) CONSTRAINT ActivityNotNull NOT NULL, 
	EmpNo VARCHAR(8),
 
	CONSTRAINT PK_EventPlan PRIMARY KEY (PlanNo),
	CONSTRAINT FK_EventPlan_EventNo FOREIGN KEY (EventNo) REFERENCES EVENTREQUEST (EventNo),
	CONSTRAINT FK_EventPlan_EmpNo FOREIGN KEY (EventNo) REFERENCES EMPLOYEE (EmpNo),
	CONSTRAINT EventPlan_Activity_Cats CHECK (Activity IN ('Setup', 'Cleanup', 'Operation')) 
	);


CREATE TABLE EventPlanLine (
	PlanNo INTEGER CONSTRAINT PlanNoNotNull NOT NULL,
	LineNo VARCHAR(2) CONSTRAINT LineNoNotNull NOT NULL,
	TimeStart TIME(0) CONSTRAINT TimeStartNotNull NOT NULL,
	TimeEnd TIME(0) CONSTRAINT TimeEndNotNull NOT NULL,
	NumberFld INTEGER CONSTRAINT NumberFldNotNull NOT NULL,
	LocNo VARCHAR(8) CONSTRAINT LocNoNotNull NOT NULL,
	ResNo VARCHAR(8) CONSTRAINT ResNoNotNull NOT NULL,
 
	CONSTRAINT PK_EventPlanLine PRIMARY KEY (PlanNo, LineNo),
	CONSTRAINT FK_EventPlanLine_PlanNo FOREIGN KEY (LineNo) REFERENCES EVENTPLAN (PlanNo),
	CONSTRAINT FK_EventPlanLine_LocNo FOREIGN KEY (LocNo) REFERENCES LOCATION (LocNo),
	CONSTRAINT FK_EventPlanLine_ResNo FOREIGN KEY (Resno) REFERENCES RESOURCETBL (ResNo),
	CONSTRAINT StartTimeBeforeEndTime CHECK (TimeStart < TimeEnd)
	);

-- ############################ Inserts ############################

Insert into EMPLOYEE (EMPNO,EMPNAME,DEPARTMENT,EMAIL,PHONE) values ('E100','Chuck Coordinator','Administration','chuck@colorado.edu','3-1111');
Insert into EMPLOYEE (EMPNO,EMPNAME,DEPARTMENT,EMAIL,PHONE) values ('E101','Mary Manager','Football','mary@colorado.edu','5-1111');
Insert into EMPLOYEE (EMPNO,EMPNAME,DEPARTMENT,EMAIL,PHONE) values ('E102','Sally Supervisor','Planning','sally@colorado.edu','3-2222');
Insert into EMPLOYEE (EMPNO,EMPNAME,DEPARTMENT,EMAIL,PHONE) values ('E103','Alan Administrator','Administration','alan@colorado.edu','3-3333');

Insert into CUSTOMER (CUSTNO,CUSTNAME,ADDRESS,INTERNAL,CONTACT,PHONE,CITY,STATE,ZIP) values ('C100','Football','Box 352200','Y','Mary Manager','6857100','Boulder','CO','80309');
Insert into CUSTOMER (CUSTNO,CUSTNAME,ADDRESS,INTERNAL,CONTACT,PHONE,CITY,STATE,ZIP) values ('C101','Men''s Basketball','Box 352400','Y','Sally Supervisor','5431700','Boulder','CO','80309');
Insert into CUSTOMER (CUSTNO,CUSTNAME,ADDRESS,INTERNAL,CONTACT,PHONE,CITY,STATE,ZIP) values ('C103','Baseball','Box 352020','Y','Bill Baseball','5431234','Boulder','CO','80309');
Insert into CUSTOMER (CUSTNO,CUSTNAME,ADDRESS,INTERNAL,CONTACT,PHONE,CITY,STATE,ZIP) values ('C104','Women''s Softball','Box 351200','Y','Sue Softball','5434321','Boulder','CO','80309');
Insert into CUSTOMER (CUSTNO,CUSTNAME,ADDRESS,INTERNAL,CONTACT,PHONE,CITY,STATE,ZIP) values ('C105','High School Football','123 AnyStreet','N','Coach Bob','4441234','Louisville','CO','80027');

Insert into RESOURCETBL (RESNO,RESNAME,RATE) values ('R100','attendant',10);
Insert into RESOURCETBL (RESNO,RESNAME,RATE) values ('R101','police',15);
Insert into RESOURCETBL (RESNO,RESNAME,RATE) values ('R102','usher',10);
Insert into RESOURCETBL (RESNO,RESNAME,RATE) values ('R103','nurse',20);
Insert into RESOURCETBL (RESNO,RESNAME,RATE) values ('R104','janitor',15);
Insert into RESOURCETBL (RESNO,RESNAME,RATE) values ('R105','food service',10);

Insert into FACILITY (FACNO,FACNAME) values ('F100','Football stadium');
Insert into FACILITY (FACNO,FACNAME) values ('F101','Basketball arena');
Insert into FACILITY (FACNO,FACNAME) values ('F102','Baseball field');
Insert into FACILITY (FACNO,FACNAME) values ('F103','Recreation room');

Insert into LOCATION (LOCNO,FACNO,LOCNAME) values ('L100','F100','Locker room');
Insert into LOCATION (LOCNO,FACNO,LOCNAME) values ('L101','F100','Plaza');
Insert into LOCATION (LOCNO,FACNO,LOCNAME) values ('L102','F100','Vehicle gate');
Insert into LOCATION (LOCNO,FACNO,LOCNAME) values ('L103','F101','Locker room');
Insert into LOCATION (LOCNO,FACNO,LOCNAME) values ('L104','F100','Ticket Booth');
Insert into LOCATION (LOCNO,FACNO,LOCNAME) values ('L105','F101','Gate');
Insert into LOCATION (LOCNO,FACNO,LOCNAME) values ('L106','F100','Pedestrian gate');

Insert into EVENTREQUEST (EVENTNO,DATEHELD,DATEREQ,CUSTNO,FACNO,DATEAUTH,STATUS,ESTCOST,ESTAUDIENCE,BUDNO) values ('E100','2018-10-25','2018-06-06','C100','F100','2018-06-08','Approved',5000,80000,'B1000');
Insert into EVENTREQUEST (EVENTNO,DATEHELD,DATEREQ,CUSTNO,FACNO,DATEAUTH,STATUS,ESTCOST,ESTAUDIENCE,BUDNO) values ('E101','2018-10-26','2018-07-28','C100','F100',NULL,'Pending',5000,80000,'B1000');
Insert into EVENTREQUEST (EVENTNO,DATEHELD,DATEREQ,CUSTNO,FACNO,DATEAUTH,STATUS,ESTCOST,ESTAUDIENCE,BUDNO) values ('E103','2018-09-21','2018-07-28','C100','F100','2018-08-01','Approved',5000,80000,'B1000');
Insert into EVENTREQUEST (EVENTNO,DATEHELD,DATEREQ,CUSTNO,FACNO,DATEAUTH,STATUS,ESTCOST,ESTAUDIENCE,BUDNO) values ('E102','2018-09-14','2018-07-28','C100','F100','2018-07-31','Approved',5000,80000,'B1000');
Insert into EVENTREQUEST (EVENTNO,DATEHELD,DATEREQ,CUSTNO,FACNO,DATEAUTH,STATUS,ESTCOST,ESTAUDIENCE,BUDNO) values ('E104','2018-12-03','2018-07-28','C101','F101','2018-07-31','Approved',2000,12000,'B1000');
Insert into EVENTREQUEST (EVENTNO,DATEHELD,DATEREQ,CUSTNO,FACNO,DATEAUTH,STATUS,ESTCOST,ESTAUDIENCE,BUDNO) values ('E105','2018-12-05','2018-07-28','C101','F101','2018-08-01','Approved',2000,10000,'B1000');
Insert into EVENTREQUEST (EVENTNO,DATEHELD,DATEREQ,CUSTNO,FACNO,DATEAUTH,STATUS,ESTCOST,ESTAUDIENCE,BUDNO) values ('E106','2018-12-12','2018-07-28','C101','F101','2018-07-31','Approved',2000,10000,'B1000');
Insert into EVENTREQUEST (EVENTNO,DATEHELD,DATEREQ,CUSTNO,FACNO,DATEAUTH,STATUS,ESTCOST,ESTAUDIENCE,BUDNO) values ('E107','2018-11-23','2018-07-28','C105','F100','2018-07-31','Denied',10000,5000,null);

Insert into EVENTPLAN (PLANNO,EVENTNO,WORKDATE,NOTES,ACTIVITY,EMPNO) values ('P100','E100','2018-10-25','Standard operation','Operation','E102');
Insert into EVENTPLAN (PLANNO,EVENTNO,WORKDATE,NOTES,ACTIVITY,EMPNO) values ('P101','E104','2018-12-03','Watch for gate crashers','Operation','E100');
Insert into EVENTPLAN (PLANNO,EVENTNO,WORKDATE,NOTES,ACTIVITY,EMPNO) values ('P102','E105','2018-12-05','Standard operation','Operation','E102');
Insert into EVENTPLAN (PLANNO,EVENTNO,WORKDATE,NOTES,ACTIVITY,EMPNO) values ('P103','E106','2018-12-12','Watch for seat switching','Operation',null);
Insert into EVENTPLAN (PLANNO,EVENTNO,WORKDATE,NOTES,ACTIVITY,EMPNO) values ('P104','E101','2018-10-26','Standard cleanup','Cleanup','E101');
Insert into EVENTPLAN (PLANNO,EVENTNO,WORKDATE,NOTES,ACTIVITY,EMPNO) values ('P105','E100','2018-10-25','Light cleanup','Cleanup','E101');
Insert into EVENTPLAN (PLANNO,EVENTNO,WORKDATE,NOTES,ACTIVITY,EMPNO) values ('P199','E102','2018-12-10','ABC','Operation','E101');
Insert into EVENTPLAN (PLANNO,EVENTNO,WORKDATE,NOTES,ACTIVITY,EMPNO) values ('P299','E101','2018-10-26',NULL,'Operation','E101');
Insert into EVENTPLAN (PLANNO,EVENTNO,WORKDATE,NOTES,ACTIVITY,EMPNO) values ('P349','E106','2018-12-12',NULL,'Setup','E101');
Insert into EVENTPLAN (PLANNO,EVENTNO,WORKDATE,NOTES,ACTIVITY,EMPNO) values ('P85','E100','2018-10-25','Standard operation','Cleanup','E102');
Insert into EVENTPLAN (PLANNO,EVENTNO,WORKDATE,NOTES,ACTIVITY,EMPNO) values ('P95','E101','2018-10-26','Extra security','Cleanup','E102');

Insert into EVENTPLANLINE (PLANNO,LINENO,TIMESTART,TIMEEND,NUMBERFLD,LOCNO,RESNO) values ('P100',1,'2018-10-25 08:00:00','2018-10-25 017:00:00',2,'L100','R100');
Insert into EVENTPLANLINE (PLANNO,LINENO,TIMESTART,TIMEEND,NUMBERFLD,LOCNO,RESNO) values ('P100',2,'2018-10-25 12:00:00','2018-10-25 17:00:00', 2,'L101','R101');
Insert into EVENTPLANLINE (PLANNO,LINENO,TIMESTART,TIMEEND,NUMBERFLD,LOCNO,RESNO) values ('P100',3,'2018-10-25 07:00:00','2018-10-25 16:30:00', 1,'L102','R102');
Insert into EVENTPLANLINE (PLANNO,LINENO,TIMESTART,TIMEEND,NUMBERFLD,LOCNO,RESNO) values ('P100',4,'2018-10-25 18:00:00','2018-10-25 22:00:00', 2,'L100','R102');
Insert into EVENTPLANLINE (PLANNO,LINENO,TIMESTART,TIMEEND,NUMBERFLD,LOCNO,RESNO) values ('P101',1,'2018-12-03 18:00:00','2018-12-03 20:00:00', 2,'L103','R100');
Insert into EVENTPLANLINE (PLANNO,LINENO,TIMESTART,TIMEEND,NUMBERFLD,LOCNO,RESNO) values ('P101',2,'2018-12-03 18:30:00','2018-12-03 19:00:00', 4,'L105','R100');
Insert into EVENTPLANLINE (PLANNO,LINENO,TIMESTART,TIMEEND,NUMBERFLD,LOCNO,RESNO) values ('P101',3,'2018-12-03 19:00:00','2018-12-03 20:00:00', 2,'L103','R103');
Insert into EVENTPLANLINE (PLANNO,LINENO,TIMESTART,TIMEEND,NUMBERFLD,LOCNO,RESNO) values ('P102',1,'2018-12-05 18:00:00','2018-12-05 19:00:00', 2,'L103','R100');
Insert into EVENTPLANLINE (PLANNO,LINENO,TIMESTART,TIMEEND,NUMBERFLD,LOCNO,RESNO) values ('P102',2,'2018-12-05 18:00:00','2018-12-05 21:00:00', 4,'L105','R100');
Insert into EVENTPLANLINE (PLANNO,LINENO,TIMESTART,TIMEEND,NUMBERFLD,LOCNO,RESNO) values ('P102',3,'2018-12-05 19:00:00','2018-12-05 22:00:00', 2,'L103','R103');
Insert into EVENTPLANLINE (PLANNO,LINENO,TIMESTART,TIMEEND,NUMBERFLD,LOCNO,RESNO) values ('P103',1,'2018-12-12 18:00:00','2018-12-12 21:00:00', 2,'L103','R100');
Insert into EVENTPLANLINE (PLANNO,LINENO,TIMESTART,TIMEEND,NUMBERFLD,LOCNO,RESNO) values ('P103',2,'2018-12-12 18:00:00','2018-12-12 21:00:00', 4,'L105','R100');
Insert into EVENTPLANLINE (PLANNO,LINENO,TIMESTART,TIMEEND,NUMBERFLD,LOCNO,RESNO) values ('P103',3,'2018-12-12 19:00:00','2018-12-12 22:00:00', 2,'L103','R103');
Insert into EVENTPLANLINE (PLANNO,LINENO,TIMESTART,TIMEEND,NUMBERFLD,LOCNO,RESNO) values ('P104',1,'2018-10-26 18:00:00','2018-10-26 22:00:00', 4,'L101','R104');
Insert into EVENTPLANLINE (PLANNO,LINENO,TIMESTART,TIMEEND,NUMBERFLD,LOCNO,RESNO) values ('P104',2,'2018-10-26 18:00:00','2018-10-26 22:00:00', 4,'L100','R104');
Insert into EVENTPLANLINE (PLANNO,LINENO,TIMESTART,TIMEEND,NUMBERFLD,LOCNO,RESNO) values ('P105',1,'2018-10-25 18:00:00','2018-10-25 22:00:00', 4,'L101','R104');
Insert into EVENTPLANLINE (PLANNO,LINENO,TIMESTART,TIMEEND,NUMBERFLD,LOCNO,RESNO) values ('P105',2,'2018-10-25 18:00:00','2018-10-25 22:00:00', 4,'L100','R104');
Insert into EVENTPLANLINE (PLANNO,LINENO,TIMESTART,TIMEEND,NUMBERFLD,LOCNO,RESNO) values ('P199',1,'2018-12-10 08:00:00','2018-12-10 12:00:00', 1,'L100','R100');
Insert into EVENTPLANLINE (PLANNO,LINENO,TIMESTART,TIMEEND,NUMBERFLD,LOCNO,RESNO) values ('P349',1,'2018-12-10 12:00:00','2018-12-12 15:30:00', 1,'L103','R100');
Insert into EVENTPLANLINE (PLANNO,LINENO,TIMESTART,TIMEEND,NUMBERFLD,LOCNO,RESNO) values ('P85',1,'2018-10-25 09:00:00','2018-10-25 17:00:00',  5,'L100','R100');
Insert into EVENTPLANLINE (PLANNO,LINENO,TIMESTART,TIMEEND,NUMBERFLD,LOCNO,RESNO) values ('P85',2,'2018-10-25 08:00:00','2018-10-25 17:00:00',  2,'L102','R101');
Insert into EVENTPLANLINE (PLANNO,LINENO,TIMESTART,TIMEEND,NUMBERFLD,LOCNO,RESNO) values ('P85',3,'2018-10-25 10:00:00','2018-10-25 15:00:00',  3,'L104','R100');
Insert into EVENTPLANLINE (PLANNO,LINENO,TIMESTART,TIMEEND,NUMBERFLD,LOCNO,RESNO) values ('P95',1,'2018-10-26 08:00:00','2018-10-26 17:00:00',  4,'L100','R100');
Insert into EVENTPLANLINE (PLANNO,LINENO,TIMESTART,TIMEEND,NUMBERFLD,LOCNO,RESNO) values ('P95',2,'2018-10-26 09:00:00','2018-10-26 17:00:00',  4,'L102','R101');
Insert into EVENTPLANLINE (PLANNO,LINENO,TIMESTART,TIMEEND,NUMBERFLD,LOCNO,RESNO) values ('P95',3,'2018-10-26 10:00:00','2018-10-26 15:00:00',  4,'L106','R100');
Insert into EVENTPLANLINE (PLANNO,LINENO,TIMESTART,TIMEEND,NUMBERFLD,LOCNO,RESNO) values ('P95',4,'2018-10-26 13:00:00','2018-10-26 17:00:00', 2,'L100','R103');
Insert into EVENTPLANLINE (PLANNO,LINENO,TIMESTART,TIMEEND,NUMBERFLD,LOCNO,RESNO) values ('P95',5,'2018-10-26 13:00:00','2018-10-26 17:00:00', 2,'L101','R104');




